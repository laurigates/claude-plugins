# Migration: v1.0 → v1.1

This document describes the migration from blueprint format version 1.0 to 1.1.

## Overview

Version 1.1 introduced:
- Manifest versioning (`.manifest.json` with `format_version` field)
- Modular rules support (`.claude/rules/`)
- ADR support (Architecture Decision Records)
- Upgrade history tracking

## Pre-Migration Checks

```bash
# Check if manifest exists but has no format_version
jq -e '.format_version' .claude/blueprints/.manifest.json 2>/dev/null || echo "v1.0 detected"
```

## Migration Steps

### Step 1: Add format_version to Manifest

Add the `format_version` field:

```json
{
  "format_version": "1.1.0",
  ...existing fields...
}
```

### Step 2: Add Structure Tracking

Add structure tracking fields:

```json
{
  "structure": {
    "has_prds": true,
    "has_work_orders": true,
    "has_ai_docs": false,
    "has_templates": false,
    "has_modular_rules": false,
    "claude_md_mode": "single"
  }
}
```

### Step 3: Add Upgrade History

Initialize upgrade history:

```json
{
  "upgrade_history": [
    {
      "from": "1.0.0",
      "to": "1.1.0",
      "date": "ISO timestamp",
      "changes": ["Added format_version", "Added structure tracking"]
    }
  ]
}
```

### Step 4: Create ADR Directory (Optional)

If user wants ADR support:

```bash
mkdir -p .claude/blueprints/adrs
```

### Step 5: Set Up Modular Rules (Optional)

If user prefers modular rules:

```bash
mkdir -p .claude/rules
```

## Post-Migration Verification

```bash
# Verify format_version is set
jq -r '.format_version' .claude/blueprints/.manifest.json
# Expected: 1.1.0
```

## Migration Summary

```
Blueprint Migration Complete (v1.0 → v1.1)

Added:
- format_version field (1.1.0)
- structure tracking
- upgrade_history

Next steps:
1. Consider enabling modular rules (/blueprint:rules)
2. Consider adding ADRs for architectural decisions (/blueprint:derive-adr)
```
